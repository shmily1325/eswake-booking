# 「需要駕駛」功能測試清單

測試日期：_________  
測試者：_________

---

## 📋 系統預約衝突檢查規則

系統會自動檢查以下衝突，防止預約問題：

### 🚤 船隻衝突
- **15分鐘接船時間**：每個預約結束後自動保留15分鐘緩衝時間
- 同一艘船不能有時間重疊的預約
- 時間檢查包括：
  - 新預約開始時間不能在現有預約的接船時間內
  - 新預約結束時間不能影響下個預約的開始
  - 預約時間不能直接重疊

### 👨‍🏫 教練衝突
- **8:00前必須指定教練**：早上8點前的預約必須選擇至少一位教練
- **教練不能同時出現在兩艘船**：同一時段教練只能在一個預約中
- 檢查範圍：同一天內該教練的所有預約時間

### 🚗 駕駛衝突
- 同一駕駛在同一時段不能有兩個預約
- 駕駛時間衝突也會檢查15分鐘緩衝時間

### 💡 其他規則
- 彈簧床不需要15分鐘接船時間（特殊規則）
- 時間槽間隔：15分鐘
- 營業時間：05:00 - 20:00

---

## ✅ 測試項目

### 📝 1. 新增預約

- [ ] **1.1** 勾選「需要駕駛」→ 預約成功新增，勾選框變藍色
- [ ] **1.2** 不勾選「需要駕駛」→ 預約成功新增，預設為 false
- [ ] **1.3** 資料庫驗證：`requires_driver` 欄位正確儲存

**驗證 SQL：**
```sql
SELECT id, contact_name, requires_driver, created_at 
FROM bookings 
WHERE DATE(start_at) >= CURRENT_DATE
ORDER BY created_at DESC 
LIMIT 10;
```

---

### ✏️ 2. 編輯預約

- [ ] **2.1** 編輯時正確載入「需要駕駛」狀態
- [ ] **2.2** 從「不需要」改成「需要」→ 保存成功
- [ ] **2.3** 從「需要」改成「不需要」→ 保存成功
- [ ] **2.4** 修改其他欄位不影響「需要駕駛」狀態

---

### 🎯 3. 排班管理頁面

- [ ] **3.1** 「需要駕駛」的預約顯示藍色標籤「🚤 需要駕駛」
- [ ] **3.2** 沒有勾選的預約不顯示標籤
- [ ] **3.3** 標籤位置正確、清晰易讀

---

### 🚫 4. 防呆驗證

- [ ] **4.1** 只指定教練，不指定駕駛 → ❌ 無法保存
- [ ] **4.2** 錯誤訊息清楚列出缺少駕駛的預約
- [ ] **4.3** 錯誤訊息包含：時間、聯絡人
- [ ] **4.4** 指定駕駛後 → ✅ 保存成功

**測試步驟：**
1. 新增明天的預約，勾選「需要駕駛」
2. 進入「排班管理」
3. 只選教練，不選駕駛
4. 點「儲存所有排班」
5. 確認出現錯誤訊息

---

### 🔢 5. 多筆預約測試

- [ ] **5.1** 3 筆都需要駕駛，漏掉 1 筆 → 錯誤訊息列出該筆
- [ ] **5.2** 3 筆都需要駕駛，漏掉 2 筆 → 錯誤訊息列出 2 筆
- [ ] **5.3** 3 筆都需要駕駛，全部指定 → 保存成功

---

### 🔄 6. 重複預約

- [ ] **6.1** 勾選「重複預約」+ 勾選「需要駕駛」
- [ ] **6.2** 新增 4 次重複預約
- [ ] **6.3** 所有重複的預約都有 `requires_driver = true`
- [ ] **6.4** 排班頁面所有重複預約都顯示標籤

---

### 🎭 7. 特殊情況

- [ ] **7.1** 同一人當教練和駕駛 → 允許保存
- [ ] **7.2** 修改預約時間，「需要駕駛」狀態保持
- [ ] **7.3** 刪除預約後重新新增 → 狀態正確重置

---

### 📱 8. 手機版測試（可選）

- [ ] **8.1** 勾選框在手機上容易點擊
- [ ] **8.2** 藍色標籤在小螢幕上清晰可見
- [ ] **8.3** 錯誤訊息在手機上完整顯示

---

## 🐛 發現的問題

| # | 問題描述 | 嚴重程度 | 復現步驟 |
|---|---------|---------|---------|
| 1 |         |         |         |
| 2 |         |         |         |
| 3 |         |         |         |

---

## 📊 測試結果

- **通過項目**：_____ / 23
- **失敗項目**：_____ / 23
- **整體評價**：[ ] 通過 [ ] 需修正 [ ] 不通過

---

## 💡 改進建議

1. 
2. 
3. 

---

## ✍️ 測試總結

<!-- 在這裡寫下測試心得、觀察到的用戶體驗問題等 -->

