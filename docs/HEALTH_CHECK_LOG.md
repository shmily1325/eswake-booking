# 🏥 系統健康檢查記錄

> **使用說明：** 每週執行一次 SQL_HEALTH_CHECKS.sql，記錄結果

> **⚠️ 重要提醒：** SQL 腳本已於 2025-11-26 更新，修正為實際的資料庫結構（使用 `booking_participants` 表）

---

## 📅 2025-11-26（今天的檢查）

### 執行人：[你的名字]
### 執行時間：[記錄時間]

---

### ✅ 檢查 1.1：沒有船隻的預約
- **結果：** [待填寫]
- **問題數量：** 
- **是否需要處理：** □ 是 / □ 否
- **備註：**

---

### ⚠️ 檢查 1.2：時長異常的預約
- **結果：** 發現 8 筆記錄
- **問題數量：** 8
- **詳細記錄：**
  ```
  ID 198 - Elaine       (2025-11-29)
  ID 178 - 大嘟嘟       (2025-11-26)
  ID 76  - Carl         (2025-11-16)
  ID 45  - VIOLA3位1初  (2025-11-15)
  ID 56  - Carl         (2025-11-15)
  ID 25  - Mandy, 阿璋  (2025-11-13)
  ID 2   - tony lee     (2025-11-12)
  ID 14  - 何峻宏       (2025-11-12)
  ```
- **是否需要處理：** □ 是 / □ 否
- **備註：**
  - 這些預約的 duration_min 是多少？< 10 還是 > 180？
  - 是測試資料嗎？
  - 需要補填 duration_min 嗎？

---

### ✅ 檢查 1.3：沒有教練的早場預約
- **結果：** [待填寫]
- **問題數量：** 
- **是否需要處理：** □ 是 / □ 否
- **備註：**

---

### ✅ 檢查 2.1：會員餘額為負數
- **結果：** [待填寫]
- **問題數量：** 
- **是否需要處理：** □ 是 / □ 否
- **備註：**
- **⚠️ 重要：** 如果有任何負數，需要立即調查！

---

### ✅ 檢查 2.4：會員餘額與交易記錄不一致
- **結果：** [待填寫]
- **問題數量：** 
- **是否需要處理：** □ 是 / □ 否
- **備註：**
- **⚠️ 重要：** 這是財務一致性檢查，非常關鍵

---

### ✅ 檢查 3.1：待處理扣款（超過 3 天）
- **結果：** [待填寫]
- **問題數量：** 
- **是否需要處理：** □ 是 / □ 否
- **備註：**

---

### ✅ 檢查 3.2：有回報但沒有交易記錄
- **結果：** [待填寫]
- **問題數量：** 
- **是否需要處理：** □ 是 / □ 否
- **備註：**
- **⚠️ 重要：** 這可能表示扣款遺漏

---

### ✅ 檢查 4.2：教練時間衝突
- **結果：** [待填寫]
- **問題數量：** 
- **是否需要處理：** □ 是 / □ 否
- **備註：**

---

### ✅ 檢查 5.1：船隻時間衝突
- **結果：** [待填寫]
- **問題數量：** 
- **是否需要處理：** □ 是 / □ 否
- **備註：**

---

### 📊 總結
- **總問題數：** [待填寫]
- **需要立即處理：** [待填寫]
- **可以忽略：** [待填寫]
- **整體健康狀態：** □ 良好 / □ 一般 / □ 需要關注 / □ 嚴重

---

### 🎯 行動項目
- [ ] 項目 1：[待填寫]
- [ ] 項目 2：[待填寫]

---

## 📅 下次檢查日期：2025-12-03

---
---

## 📅 [下次檢查日期]

### 執行人：
### 執行時間：

[複製上面的模板繼續記錄...]

---

## 📋 檢查頻率建議

### 每週必做（高優先級）⭐⭐⭐
- ✅ 檢查 2.1：會員餘額為負數
- ✅ 檢查 2.4：餘額與交易不一致
- ✅ 檢查 3.1：待處理扣款（超過 3 天）
- ✅ 檢查 3.2：有回報但沒有交易記錄

### 每週建議（中優先級）⭐⭐
- ✅ 檢查 1.2：時長異常的預約
- ✅ 檢查 1.3：沒有教練的早場預約
- ✅ 檢查 4.2：教練時間衝突
- ✅ 檢查 5.1：船隻時間衝突

### 每月執行（低優先級）⭐
- ✅ 檢查 1.1：沒有船隻的預約
- ✅ 檢查 1.4：預約沒有填表人
- ✅ 檢查 2.2：交易金額異常
- ✅ 檢查 4.1：預約有多個教練

---

## 🎯 重點說明

### 什麼是「正常的異常」？
有些檢查結果看起來是異常，但實際上可能是正常的：

1. **時長異常**
   - 可能是測試資料
   - 可能是取消後重新建立的預約
   - 可能是特殊活動（短時間體驗）

2. **教練/船隻衝突**
   - 可能是故意的（教練兼駕駛）
   - 可能是前後預約銜接（結束時間 = 開始時間）

3. **待處理扣款**
   - 可能是週末的預約（週一處理）
   - 可能是需要特別確認的扣款

### 什麼是「真正的問題」？⚠️

1. **會員餘額為負數** → 絕對不正常，立即調查
2. **餘額與交易記錄不一致** → 嚴重問題，需要修正
3. **有回報但沒扣款** → 可能造成財務損失
4. **現金回報還在 pending** → 流程卡住了

---

## 💡 使用技巧

1. **第一次執行**
   - 會發現很多「歷史遺留問題」
   - 不用緊張，先記錄下來
   - 評估哪些需要處理，哪些可以接受

2. **定期執行**
   - 建立基準線（Baseline）
   - 觀察趨勢（問題變多還是變少？）
   - 如果新問題持續出現，表示流程有缺陷

3. **記錄原則**
   - 簡潔明瞭（不用寫太多）
   - 重點是「趨勢」而不是「數字」
   - 發現問題 → 記錄 → 處理 → 驗證

---

## 📞 緊急應對

如果發現嚴重問題（會員餘額負數、財務不一致）：

1. **立即停止相關操作**
2. **備份當前資料**
3. **記錄問題詳情**
4. **調查原因**
5. **修正資料**
6. **驗證修正結果**
7. **記錄到此文檔**

---

